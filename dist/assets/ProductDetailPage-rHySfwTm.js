import{c as C,r as u,j as e,X as A,R as F,e as z,f as E,u as R,L as D,V as g}from"./index-BkUxVZaB.js";import{u as U,s as W}from"./useProducts-DXAfstdD.js";import{D as B,H as G,u as _,a as J,G as Q}from"./index-CkAp2s5T.js";import{a as K}from"./formatters-DcVfRb3N.js";import{f as X}from"./index-Cohc17GS.js";import{F as Y,a as Z,b as T,E as P}from"./formik.esm-DW3Up1cQ.js";import{c as ee,a as L,b as se}from"./index.esm-DgzsvJR_.js";import{A as ae}from"./arrow-left-DE6iWCAM.js";import{S as te}from"./shopping-cart-Pxo7q16x.js";import{S as le}from"./share-2-CfdRWOZ8.js";import{S as ie}from"./square-pen-BcJ-Xf24.js";import"./productService-DcEclZUh.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=C("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=C("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=C("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=C("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),V={THUMBNAIL:"thumbnail"},ce=({item:s,index:a,moveItem:n,onClick:d,isActive:m})=>{const c=F.useRef(null),[,j]=_({accept:V.THUMBNAIL,hover(h){h.index!==a&&(n(h.index,a),h.index=a)}}),[{isDragging:x},o,t]=J({type:V.THUMBNAIL,item:{index:a},collect:h=>({isDragging:h.isDragging()})});return o(j(c)),e.jsx("div",{ref:t,style:{opacity:x?.5:1},className:`relative cursor-pointer ${m?"ring-2 ring-primary-500":""}`,onClick:d,children:e.jsxs("div",{ref:c,className:"relative",children:[s.type==="video"?e.jsxs("div",{className:"w-16 h-16 rounded-md bg-neutral-200 flex items-center justify-center relative",children:[e.jsx($,{className:"h-6 w-6 text-neutral-500"}),e.jsx("span",{className:"absolute bottom-0 right-0 bg-primary-600 text-white text-xs px-1 rounded-tl-md",children:"Video"})]}):e.jsx("img",{src:s.url,alt:`${name} thumbnail ${a+1}`,className:"gallery-thumbnail"}),e.jsx("div",{className:"absolute top-0 right-0 bg-black/50 p-1 rounded-bl-md cursor-grab",children:e.jsx(Q,{className:"h-4 w-4 text-white"})})]})})},de=({images:s,videos:a,name:n,onMediaReorder:d})=>{const m=[...s.map(l=>({type:"image",url:l})),...a.map(l=>({type:"video",url:l}))],[c,j]=u.useState(m),[x,o]=u.useState(0),[t,h]=u.useState(!1),[k,y]=u.useState(!1),p=c[x],M=l=>o(l),v=()=>h(!t),r=()=>{const l=document.getElementById(`gallery-video-${x}`);l&&(k?l.pause():l.play())},N=(l,w)=>{const O=c[l],S=[...c];if(S.splice(l,1),S.splice(w,0,O),j(S),d){const H=S.filter(b=>b.type==="image").map(b=>b.url),q=S.filter(b=>b.type==="video").map(b=>b.url);d({images:H,videos:q})}};return e.jsx(B,{backend:G,children:e.jsxs("div",{className:"gallery-container",children:[e.jsx("div",{className:"relative aspect-square md:aspect-[4/3] lg:aspect-[16/9] bg-neutral-100 overflow-hidden rounded-lg",onClick:v,children:p.type==="video"?e.jsxs("div",{className:"w-full h-full flex items-center justify-center",children:[e.jsx("video",{id:`gallery-video-${x}`,src:p.url,controls:!1,className:"max-h-full max-w-full object-contain",onPlay:()=>y(!0),onPause:()=>y(!1),onClick:l=>{l.stopPropagation(),r()}}),!k&&e.jsx("button",{onClick:l=>{l.stopPropagation(),r()},className:"absolute inset-0 m-auto w-16 h-16 flex items-center justify-center bg-black/40 hover:bg-black/60 rounded-full text-white",children:e.jsx($,{className:"h-8 w-8"})})]}):e.jsx("img",{src:p.url,alt:`${n} - image ${x+1}`,className:"w-full h-full object-contain"})}),c.length>1&&e.jsx("div",{className:"gallery-thumbnails",children:c.map((l,w)=>e.jsx(ce,{item:l,index:w,moveItem:N,onClick:()=>M(w),isActive:x===w},l.url))}),t&&e.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 sm:p-8",children:[e.jsx("button",{onClick:v,className:"absolute top-4 right-4 text-white bg-black/50 hover:bg-black/70 p-2 rounded-full",children:e.jsx(A,{className:"h-6 w-6"})}),e.jsx("div",{className:"w-full max-w-6xl max-h-[90vh]",children:p.type==="video"?e.jsx("video",{src:p.url,controls:!0,autoPlay:!0,className:"w-full h-full object-contain"}):e.jsx("img",{src:p.url,alt:`${n} - fullscreen`,className:"max-h-[80vh] max-w-full mx-auto object-contain"})})]})]})})},me=({onClose:s,productName:a,productUrl:n})=>{const d=`https://api.whatsapp.com/send?text=${encodeURIComponent(`Check out this amazing gemstone: ${a}

${n}`)}`;return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Share Product"}),e.jsx("button",{onClick:s,className:"text-neutral-500 hover:text-neutral-800",children:e.jsx(A,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"btn-outline w-full flex items-center justify-center",children:[e.jsx(ne,{className:"h-5 w-5 mr-2"})," Share on WhatsApp"]}),e.jsxs("a",{href:"https://www.instagram.com/",target:"_blank",rel:"noopener noreferrer",className:"btn-outline w-full flex items-center justify-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2"})," Share on Instagram"]}),e.jsx("p",{className:"text-xs text-neutral-500 text-center",children:"Note: Instagram sharing from web is limited. It's best to share from the mobile app."})]})]})})},xe=({product:s})=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900",children:s.name}),e.jsx("p",{className:"text-lg text-neutral-600 mt-2",children:s.description}),e.jsxs("div",{className:"mt-4 flex items-baseline gap-4",children:[e.jsx("span",{className:"text-3xl font-bold text-primary-600",children:K(s.price)}),e.jsxs("span",{className:"text-sm font-semibold text-neutral-500",children:["(Markup: ",s.markup,"x)"]})]})]}),i=({label:s,value:a})=>{if(a==null||a==="")return null;const n=typeof a=="boolean"?a?"Yes":"No":a;return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-500",children:s}),e.jsx("p",{className:"text-base font-medium text-neutral-900",children:n})]})},he=({product:s})=>e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-4",children:"Product Overview"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsx(i,{label:"SKU",value:s.id}),e.jsx(i,{label:"Condition",value:s.condition}),e.jsx(i,{label:"Reservation Status",value:s.reservationStatus}),s.productType==="LooseStone"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{label:"Gemstone Type",value:s.gemstoneType}),e.jsx(i,{label:"Variety",value:s.variety}),e.jsx(i,{label:"Origin",value:s.origin}),e.jsx(i,{label:"Creation Method",value:s.creationMethod}),e.jsx(i,{label:"Carat Weight",value:s.caratWeight}),e.jsx(i,{label:"Shape",value:s.shape})]}),s.productType==="CarvedIdol"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{label:"Material",value:s.material}),e.jsx(i,{label:"Deity/Figure",value:s.deityFigure}),e.jsx(i,{label:"Origin",value:s.origin}),e.jsx(i,{label:"Weight",value:s.weight})]}),s.productType==="Jewelry"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{label:"Category",value:s.category}),e.jsx(i,{label:"Style",value:s.style}),e.jsx(i,{label:"Metal",value:s.metal}),e.jsx(i,{label:"Metal Weight",value:s.metalWeight}),e.jsx(i,{label:"Ring Size",value:s.ringSize})]})]})]}),f=({label:s,value:a})=>a?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-500",children:s}),e.jsx("p",{className:"text-base font-medium text-neutral-900",children:a})]}):null,ue=({product:s})=>s.productType!=="Jewelry"?null:e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-4",children:"Craftsmanship & Metal"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsx(f,{label:"Metal",value:s.metal}),e.jsx(f,{label:"Metal Purity",value:s.metalPurity}),e.jsx(f,{label:"Metal Weight",value:s.metalWeight}),e.jsx(f,{label:"Metal Color",value:s.metalColor}),e.jsx(f,{label:"Hallmark",value:s.hallmark}),e.jsx(f,{label:"Plating",value:s.plating}),e.jsx(f,{label:"Warranty",value:s.warranty}),e.jsx(f,{label:"Labor Cost",value:s.laborCost})]})]}),I=({label:s,value:a})=>a?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-500",children:s}),e.jsx("p",{className:"text-base font-medium text-neutral-900",children:a})]}):null,je=({product:s})=>e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-4",children:"Certifications & Authenticity"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[s.productType==="LooseStone"&&e.jsxs(e.Fragment,{children:[e.jsx(I,{label:"Origin",value:s.origin}),e.jsx(I,{label:"Certification ID",value:s.certificationId})]}),s.productType==="CarvedIdol"&&e.jsx(I,{label:"Origin",value:s.origin}),e.jsx(I,{label:"Appraisal Date",value:s.appraisalDate}),e.jsx(I,{label:"Insurance Value",value:s.insuranceValue})]})]}),pe=({movements:s})=>s.length===0?e.jsx("p",{children:"No movement history for this product."}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Date"}),e.jsx("th",{className:"text-left p-2",children:"From"}),e.jsx("th",{className:"text-left p-2",children:"To"}),e.jsx("th",{className:"text-left p-2",children:"User"})]})}),e.jsx("tbody",{children:s.map(a=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2",children:X(new Date(a.date),"MMM d, yyyy")}),e.jsx("td",{className:"p-2",children:a.fromLocation}),e.jsx("td",{className:"p-2",children:a.toLocation}),e.jsx("td",{className:"p-2",children:a.userId})]},a.id))})]}),fe=({productId:s,onSubmit:a})=>{const n={productId:s,fromLocation:"",toLocation:"",date:new Date().toISOString().split("T")[0]};return e.jsx(Y,{initialValues:n,validationSchema:ee({fromLocation:L().required("Required"),toLocation:L().required("Required"),date:se().required("Required")}),onSubmit:a,children:e.jsxs(Z,{className:"space-y-4",children:[e.jsx(T,{name:"fromLocation",placeholder:"From Location",className:"form-input"}),e.jsx(P,{name:"fromLocation"}),e.jsx(T,{name:"toLocation",placeholder:"To Location",className:"form-input"}),e.jsx(P,{name:"toLocation"}),e.jsx(T,{name:"date",type:"date",className:"form-input"}),e.jsx(P,{name:"date"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Record Movement"})]})})},be=[{id:"1",productId:"1",fromLocation:"Vault A",toLocation:"Showcase 1",date:new Date().toISOString(),userId:"1"},{id:"2",productId:"1",fromLocation:"Showcase 1",toLocation:"Vault B",date:new Date().toISOString(),userId:"2"}],ge=({product:s})=>{const[a,n]=u.useState("ecommerce"),{user:d}=z(),[m,c]=u.useState(be),j=[{id:"ecommerce",label:"E-commerce"},{id:"integration",label:"System Integration"},{id:"compliance",label:"Audit & Compliance"},{id:"movement",label:"Movement History"}],x=o=>{if(d){const t={...o,id:(m.length+1).toString(),userId:d.id};c([...m,t])}};return e.jsxs("div",{className:"card mt-8",children:[e.jsx("div",{className:"border-b border-neutral-200",children:e.jsx("nav",{className:"-mb-px flex space-x-6 px-6","aria-label":"Tabs",children:j.map(o=>e.jsx("button",{onClick:()=>n(o.id),className:`${a===o.id?"border-primary-500 text-primary-600":"border-transparent text-neutral-500 hover:text-neutral-700 hover:border-neutral-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:o.label},o.id))})}),e.jsxs("div",{className:"p-6",children:[a==="ecommerce"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SEO Title:"})," ",s.seoTitle]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SEO Description:"})," ",s.seoDescription]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Tags:"})," ",s.tags.join(", ")]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Category Hierarchy:"})," ",s.categoryHierarchy]})]}),a==="integration"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Shopify ID:"})," ",s.platformIds.shopifyId]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Etsy ID:"})," ",s.platformIds.etsyId]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"eBay ID:"})," ",s.platformIds.ebayId]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Amazon ID:"})," ",s.platformIds.amazonId]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Google Shopping ID:"})," ",s.platformIds.googleShoppingId]})]}),a==="compliance"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Insurance Value:"})," ",s.insuranceValue]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Appraisal Date:"})," ",s.appraisalDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Tax Category:"})," ",s.taxCategory]})]}),a==="movement"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Record New Movement"}),e.jsx(fe,{productId:s.id,onSubmit:x}),e.jsx("hr",{className:"my-6"}),e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Movement History"}),e.jsx(pe,{movements:m})]})]})]})},Le=()=>{var v;const{id:s}=E(),a=R(),{getProduct:n,deleteProduct:d,updateProduct:m}=U(),[c,j]=u.useState(!1),[x,o]=u.useState(!1);if(!s)return e.jsx("div",{children:"Invalid product ID"});const[t,h]=u.useState(null),[k,y]=u.useState(!0);if(F.useEffect(()=>{let r=!0;return y(!0),n(s).then(N=>{r&&h(N)}).catch(()=>{r&&h(null)}).finally(()=>{r&&y(!1)}),()=>{r=!1}},[s,n]),k)return e.jsx("div",{className:"container-page flex items-center justify-center",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Loading..."})});if(!t)return e.jsxs("div",{className:"container-page flex flex-col items-center justify-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Product Not Found"}),e.jsx(D,{to:"/inventory",className:"btn-primary mt-4",children:"Back to Inventory"})]});const p=async()=>{await d(s)?(g.success("Product deleted successfully"),a("/inventory")):g.error("Failed to delete product")},M=async()=>{if(t)try{const r=await W.createProduct(t);await m(t.id,{...t,platformIds:{...t.platformIds,shopifyId:r.id.toString()}}),g.success("Product synced to Shopify successfully!")}catch(r){g.error("Failed to sync product to Shopify."),console.error(r)}};return e.jsxs("div",{className:"container-page",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs(D,{to:"/inventory",className:"inline-flex items-center text-neutral-600 hover:text-neutral-900",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Back to Inventory"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:M,className:"btn-outline",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Sync to Shopify"]}),e.jsx("button",{onClick:()=>{fetch("/api/shopify-webhook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.platformIds.shopifyId,title:`${t.name} (Updated from Shopify)`,body_html:t.description,vendor:t.supplier,product_type:t.productType,variants:[{price:t.price,sku:t.id}]})}),g.success("Simulated webhook call sent!")},className:"btn-outline",children:"Simulate Webhook"}),e.jsx("button",{onClick:()=>o(!0),className:"btn-outline",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(D,{to:`/product/${s}/edit`,className:"btn-primary",children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{if(t){const r=t.productType==="LooseStone"?t.quantity-1:(t.inventoryQuantity||0)-1;if(r>=0){const N={...t,...t.productType==="LooseStone"?{quantity:r}:{inventoryQuantity:r}};m(t.id,N),g.success("Simulated order placed!")}else g.error("Not enough inventory to place order.")}},className:"btn-outline",children:"Simulate Order"}),e.jsx("button",{onClick:()=>j(!0),className:"btn-outline border-error-300 text-error-700 hover:bg-error-50",children:e.jsx(oe,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx(de,{images:t.images||[],video:(v=t.videos)==null?void 0:v[0],name:t.name}),e.jsxs("div",{className:"card p-6 mt-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-4",children:"Description"}),e.jsx("p",{className:"text-neutral-700 whitespace-pre-wrap",children:t.description})]}),e.jsx(ge,{product:t})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsx(xe,{product:t}),e.jsx(he,{product:t}),e.jsx(ue,{product:t}),e.jsx(je,{product:t})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Delete Product"}),e.jsxs("p",{className:"text-neutral-600 my-4",children:['Are you sure you want to delete "',t.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{className:"btn-outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx("button",{className:"btn bg-error-600 text-white hover:bg-error-700",onClick:p,children:"Delete"})]})]})}),x&&e.jsx(me,{onClose:()=>o(!1),productName:t.name,productUrl:window.location.href})]})};export{Le as default};
