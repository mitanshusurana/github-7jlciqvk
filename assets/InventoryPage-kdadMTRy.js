import{c as k,r as u,R as E,j as e,X as M,u as T,L as G}from"./index-meUAYj0N.js";import{Q as O,H as P}from"./html5-qrcode-scanner-ChCOqT6o.js";import{u as q}from"./useProducts-B8YLfgLS.js";import{P as B}from"./ProductCard-CaxabZLM.js";import{S as Q,F as U}from"./search-DtAretg-.js";import{C as F}from"./calendar-Bm5QdCBY.js";import{P as D}from"./plus-CDyJQsTK.js";import"./productService-CSvu92TM.js";import"./square-pen-CpoMx9bd.js";import"./index-Cohc17GS.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=k("ArrowDownAZ",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=k("ArrowUpZA",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M15 4h5l-5 6h5",key:"8asdl1"}],["path",{d:"M15 20v-3.5a2.5 2.5 0 0 1 5 0V20",key:"r6l5cz"}],["path",{d:"M20 18h-5",key:"18j1r2"}]]);var S=new Map,N=new WeakMap,R=0,_=void 0;function L(s){return s?(N.has(s)||(R+=1,N.set(s,R.toString())),N.get(s)):"0"}function $(s){return Object.keys(s).sort().filter(a=>s[a]!==void 0).map(a=>`${a}_${a==="root"?L(s.root):s[a]}`).toString()}function Z(s){const a=$(s);let c=S.get(a);if(!c){const d=new Map;let m;const l=new IntersectionObserver(t=>{t.forEach(r=>{var o;const i=r.isIntersecting&&m.some(x=>r.intersectionRatio>=x);s.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=i),(o=d.get(r.target))==null||o.forEach(x=>{x(i,r)})})},s);m=l.thresholds||(Array.isArray(s.threshold)?s.threshold:[s.threshold||0]),c={id:a,observer:l,elements:d},S.set(a,c)}return c}function W(s,a,c={},d=_){if(typeof window.IntersectionObserver>"u"&&d!==void 0){const o=s.getBoundingClientRect();return a(d,{isIntersecting:d,target:s,intersectionRatio:typeof c.threshold=="number"?c.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:m,observer:l,elements:t}=Z(c),r=t.get(s)||[];return t.has(s)||t.set(s,r),r.push(a),l.observe(s),function(){r.splice(r.indexOf(a),1),r.length===0&&(t.delete(s),l.unobserve(s)),t.size===0&&(l.disconnect(),S.delete(m))}}function z({threshold:s,delay:a,trackVisibility:c,rootMargin:d,root:m,triggerOnce:l,skip:t,initialInView:r,fallbackInView:o,onChange:i}={}){var x;const[n,f]=u.useState(null),h=u.useRef(i),[j,b]=u.useState({inView:!!r,entry:void 0});h.current=i,u.useEffect(()=>{if(t||!n)return;let g;return g=W(n,(C,w)=>{b({inView:C,entry:w}),h.current&&h.current(C,w),w.isIntersecting&&l&&g&&(g(),g=void 0)},{root:m,rootMargin:d,threshold:s,trackVisibility:c,delay:a},o),()=>{g&&g()}},[Array.isArray(s)?s.toString():s,n,m,d,l,t,c,o,a]);const v=(x=j.entry)==null?void 0:x.target,y=u.useRef(void 0);!n&&v&&!l&&!t&&y.current!==v&&(y.current=v,b({inView:!!r,entry:void 0}));const p=[f,j.inView,j.entry];return p.ref=p[0],p.inView=p[1],p.entry=p[2],p}const H=({products:s=[],loading:a=!1,onLoadMore:c,hasMore:d=!1})=>{const{ref:m,inView:l}=z({threshold:0,triggerOnce:!1});return E.useEffect(()=>{l&&d&&c&&!a&&c()},[l,d,c,a]),s.length===0&&!a?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"mt-2 text-lg font-medium text-neutral-900",children:"No products found"}),e.jsx("p",{className:"mt-1 text-sm text-neutral-500",children:"Try adjusting your search or filter criteria."})]})}):e.jsxs("div",{className:"gem-grid animate-fade-in",children:[(Array.isArray(s)?s:[]).map(t=>e.jsx(B,{product:t},t.id)),a&&Array.from({length:4}).map((t,r)=>e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"aspect-square bg-neutral-200 animate-pulse"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-5 bg-neutral-200 animate-pulse rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-neutral-200 animate-pulse rounded w-1/2"}),e.jsxs("div",{className:"mt-3 flex justify-between",children:[e.jsx("div",{className:"h-3 bg-neutral-200 animate-pulse rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-neutral-200 animate-pulse rounded w-1/4"})]})]})]},`skeleton-${r}`)),d&&e.jsx("div",{ref:m,className:"h-10 w-full"})]})},X=({onFilterChange:s,categories:a,styles:c,metals:d})=>{const[m,l]=u.useState(!1),[t,r]=u.useState({search:"",category:"",style:"",metal:"",clarityGrade:void 0,rarity:void 0,workmanshipGrade:void 0,dateFrom:"",dateTo:"",tags:[],sortBy:"createdAt",sortOrder:"desc"}),o=()=>{l(!m)},i=n=>{const{name:f,value:h}=n.target;r(j=>({...j,[f]:h}))},x=()=>{r({search:"",category:"",dateFrom:"",dateTo:"",tags:[],sortBy:"createdAt",sortOrder:"desc"})};return u.useEffect(()=>{const n=setTimeout(()=>{s(t)},300);return()=>clearTimeout(n)},[t,s]),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-64 lg:w-96",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx(Q,{className:"h-4 w-4 text-neutral-400"})}),e.jsx("input",{type:"text",name:"search",value:t.search,onChange:i,className:"form-input pl-10 w-full",placeholder:"Search products..."})]}),e.jsxs("div",{className:"flex items-center space-x-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"sortBy",value:t.sortBy,onChange:i,className:"form-select pr-10 appearance-none",children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"createdAt",children:"Date Added"}),e.jsx("option",{value:"weight",children:"Weight"}),e.jsx("option",{value:"value",children:"Value"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:t.sortOrder==="asc"?e.jsx(I,{className:"h-4 w-4 text-neutral-400"}):e.jsx(A,{className:"h-4 w-4 text-neutral-400"})})]}),e.jsx("button",{onClick:()=>r(n=>({...n,sortOrder:n.sortOrder==="asc"?"desc":"asc"})),className:"btn-outline p-2",children:t.sortOrder==="asc"?e.jsx(I,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"})}),e.jsxs("button",{onClick:o,className:`btn ${m?"bg-primary-600 text-white":"btn-outline"} flex items-center`,children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:"Filter"})]})]})]}),m&&e.jsxs("div",{className:"bg-white rounded-md shadow-md mt-2 p-4 animate-slide-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:"Filters"}),e.jsxs("button",{onClick:x,className:"text-sm text-neutral-500 hover:text-neutral-700 flex items-center",children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Clear all"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"form-label",children:"Category"}),e.jsxs("select",{id:"category",name:"category",value:t.category,onChange:i,className:"form-select",children:[e.jsx("option",{value:"",children:"All Categories"}),a.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"style",className:"form-label",children:"Style"}),e.jsxs("select",{id:"style",name:"style",value:t.style,onChange:i,className:"form-select",children:[e.jsx("option",{value:"",children:"All Styles"}),c.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"metal",className:"form-label",children:"Metal"}),e.jsxs("select",{id:"metal",name:"metal",value:t.metal,onChange:i,className:"form-select",children:[e.jsx("option",{value:"",children:"All Metals"}),d.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"clarityGrade",className:"form-label",children:"Clarity Grade"}),e.jsxs("select",{id:"clarityGrade",name:"clarityGrade",value:t.clarityGrade,onChange:i,className:"form-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"FL",children:"FL"}),e.jsx("option",{value:"IF",children:"IF"}),e.jsx("option",{value:"VVS1",children:"VVS1"}),e.jsx("option",{value:"VVS2",children:"VVS2"}),e.jsx("option",{value:"VS1",children:"VS1"}),e.jsx("option",{value:"VS2",children:"VS2"}),e.jsx("option",{value:"SI1",children:"SI1"}),e.jsx("option",{value:"SI2",children:"SI2"}),e.jsx("option",{value:"I1",children:"I1"}),e.jsx("option",{value:"I2",children:"I2"}),e.jsx("option",{value:"I3",children:"I3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"rarity",className:"form-label",children:"Rarity"}),e.jsxs("select",{id:"rarity",name:"rarity",value:t.rarity,onChange:i,className:"form-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Common",children:"Common"}),e.jsx("option",{value:"Uncommon",children:"Uncommon"}),e.jsx("option",{value:"Rare",children:"Rare"}),e.jsx("option",{value:"Very Rare",children:"Very Rare"}),e.jsx("option",{value:"Unique",children:"Unique"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"workmanshipGrade",className:"form-label",children:"Workmanship Grade"}),e.jsxs("select",{id:"workmanshipGrade",name:"workmanshipGrade",value:t.workmanshipGrade,onChange:i,className:"form-select",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Standard",children:"Standard"}),e.jsx("option",{value:"Fine",children:"Fine"}),e.jsx("option",{value:"Excellent",children:"Excellent"}),e.jsx("option",{value:"Masterpiece",children:"Masterpiece"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"dateFrom",className:"form-label flex items-center",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"From Date"]}),e.jsx("input",{type:"date",id:"dateFrom",name:"dateFrom",value:t.dateFrom,onChange:i,className:"form-input"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"dateTo",className:"form-label flex items-center",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"To Date"]}),e.jsx("input",{type:"date",id:"dateTo",name:"dateTo",value:t.dateTo,onChange:i,className:"form-input"})]})]})]})]})},Y=["Gold","Silver","Platinum","Palladium","Rhodium","Iridium","Other"],V=["Antique","Modern","Temple","Classic","Contemporary","Ethnic","Other"],ce=()=>{const{products:s,loading:a,hasMore:c,loadMore:d,setFilters:m}=q(),[l,t]=u.useState(!1),r=u.useRef(null),o=u.useRef(!1),i="inventory-qr-region",x=T(),n=h=>{m(h)},f=u.useCallback(async()=>{if(r.current)try{o.current&&await r.current.stop(),await r.current.clear()}catch{}finally{r.current=null,o.current=!1}},[]);return u.useEffect(()=>()=>{f()},[f]),u.useEffect(()=>{let h=!1;return(async()=>{if(l&&!r.current&&document.getElementById(i)){const v=new P(i);r.current=v;try{await v.start({facingMode:"environment"},{fps:10,qrbox:250},async y=>{h||(console.log("QR decoded value:",y),t(!1),x(`/product/${y}`),setTimeout(()=>{f()},300))},()=>{}),o.current=!0}catch{t(!1),r.current=null,o.current=!1}}!l&&r.current&&o.current&&f()})(),()=>{h=!0}},[l,x,f]),e.jsxs("div",{className:"container-page",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900",children:"Product Inventory"}),e.jsx("p",{className:"mt-1 text-neutral-500",children:"Browse, search, and manage your product collection"})]}),e.jsxs("div",{className:"mt-4 md:mt-0 flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:"btn-outline flex items-center",onClick:()=>t(h=>!h),title:"Scan QR",children:[e.jsx(O,{className:"h-5 w-5 mr-1"}),"Scan QR"]}),e.jsxs(G,{to:"/product/new",className:"btn-primary flex items-center space-x-1",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{children:"Add New Product"})]})]})]}),e.jsxs("div",{className:"mb-4 flex flex-col items-center",style:{display:l?"flex":"none"},children:[e.jsx("div",{id:i,style:{width:300}}),e.jsx("button",{type:"button",className:"btn-outline mt-2",onClick:()=>t(!1),children:"Close Scanner"})]}),e.jsx(X,{onFilterChange:n,categories:V,styles:V,metals:Y}),e.jsx(H,{products:s.content??[],loading:a,hasMore:c,onLoadMore:d})]})};export{ce as default};
